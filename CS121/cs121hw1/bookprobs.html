<html><head>
<style>
div.answer {
    padding-left: 20pt;
    padding-bottom: 12pt;
}

div.comment {
    padding-left: 4pt;
    padding-bottom: 12pt;
}

div.errors {
    border: 1px solid red;
    margin-top: 12pt;
    margin-left: 4pt;
    padding-left: 4pt;
    color: red;
    font-weight: bold;
}

.relvar {
    font-style: italic;
}

.attr_name {
    font-style: italic;
}

.group_operator {
    font-family: Lucida Calligraphy;
}

.func_name {
    font-weight: bold;
}

.operator {
}

.string {
    color: #007F00;
}

.number {
    color: #0000FF;
}

</style>
</head><body>
<h1>File:  bookprobs.txt</h1>
<h2 id='Problem 2.5a'>Problem 2.5a</h2>
<div class='answer'>
&Pi;<sub><span class='attr_name'>person_name</span></sub>(&sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"First Bank Corporation"</span></sub>(<span class='relvar'>works</span>))
</div>
<h2 id='Problem 2.5b'>Problem 2.5b</h2>
<div class='answer'>
&Pi;<sub><span class='attr_name'>person_name</span>, <span class='attr_name'>city</span></sub>(&sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"First Bank Corporation"</span></sub>(<span class='relvar'>works</span> &bowtie; <span class='relvar'>employee</span>))
</div>
<h2 id='Problem 2.5c'>Problem 2.5c</h2>
<div class='answer'>
<em>satMoney</em> &larr; &Pi;<sub><span class='attr_name'>person_name</span></sub>(&sigma;<sub><span class='attr_name'>salary</span> <span class='operator'>&gt;</span> <span class='number'>10000</span> &and; <span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"First Bank Corporation"</span></sub>(<span class='relvar'>works</span>))<br /><span class='relvar'>employee</span> &bowtie; <span class='relvar'>satMoney</span>
</div>
<h2 id='Problem 2.5d'>Problem 2.5d</h2>
<div class='answer'>
<em>companyInfo</em> &larr; <span class='relvar'>works</span> &bowtie; <span class='relvar'>company</span><br /><em>people</em> &larr; &sigma;<sub><span class='attr_name'>companyInfo</span>.<span class='attr_name'>person_name</span> <span class='operator'>=</span> <span class='attr_name'>employee</span>.<span class='attr_name'>person_name</span> &and; <span class='attr_name'>companyInfo</span>.<span class='attr_name'>city</span> <span class='operator'>=</span> <span class='attr_name'>employee</span>.<span class='attr_name'>city</span></sub>(<span class='relvar'>employee</span> &times; <span class='relvar'>companyInfo</span>)<br />&Pi;<sub><span class='attr_name'>employee</span>.<span class='attr_name'>person_name</span></sub>(<span class='relvar'>people</span>)
</div>
<h2 id='Problem 2.5e'>Problem 2.5e</h2>
<div class='answer'>
<em>citiesFind</em> &larr; &Pi;<sub><span class='attr_name'>city</span></sub>(&sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"Small Bank Corporation"</span></sub>(<span class='relvar'>company</span>))<br /><span class='relvar'>company</span> &divide; <span class='relvar'>citiesFind</span>
</div>
<h2 id='Problem 2.6a'>Problem 2.6a</h2>
<div class='answer'>
&Pi;<sub><span class='attr_name'>customer</span>.<span class='attr_name'>name</span>, <span class='attr_name'>loan_number</span>, <span class='attr_name'>amount</span>, <span class='attr_name'>customer_city</span></sub>((<span class='relvar'>borrower</span> &bowtie; <span class='relvar'>customer</span>) &bowtie; <span class='relvar'>loan</span>)
</div>
<div class='comment'>
Jackson isn't included because he doesn't have an entry in the customer relation.
</div>
<h2 id='Problem 2.6b'>Problem 2.6b</h2>
<div class='comment'>
I'd add a tuple for Jackson in the customer relation.
</div>
<h2 id='Problem 2.6c'>Problem 2.6c</h2>
<div class='answer'>
&Pi;<sub><span class='attr_name'>customer_name</span>, <span class='attr_name'>loan_number</span>, <span class='attr_name'>amount</span>, <span class='attr_name'>customer_city</span></sub>((<span class='relvar'>borrower</span> &#x27d5; <span class='relvar'>customer</span>) &bowtie; <span class='relvar'>loan</span>)
</div>
<h2 id='Problem 2.7a'>Problem 2.7a</h2>
<div class='answer'>
<em>works</em> &larr; &sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>&ne;</span> <span class='string'>"First Bank Corporation"</span></sub>(<span class='relvar'>works</span>) &cup; &Pi;<sub><span class='attr_name'>person_name</span>, <span class='attr_name'>company_name</span>, <span class='attr_name'>salary</span> &times; <span class='number'>1.10</span></sub>(&sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"First Bank Corporation"</span></sub>(<span class='relvar'>works</span>))
</div>
<h2 id='Problem 2.7b'>Problem 2.7b</h2>
<div class='answer'>
<em>managerNames</em> &larr; &Pi;<sub><span class='attr_name'>manager_name</span></sub>(<span class='relvar'>manages</span>)<br /><em>managers</em> &larr; &Pi;<sub><span class='attr_name'>person_name</span>, <span class='attr_name'>company_name</span>, <span class='attr_name'>salary</span></sub>(&sigma;<sub><span class='attr_name'>manager_name</span> <span class='operator'>=</span> <span class='attr_name'>person_name</span></sub>(<span class='relvar'>managerNames</span> &times; <span class='relvar'>works</span>))<br /><em>updatedManagers</em> &larr; &Pi;<sub><span class='attr_name'>person_name</span>, <span class='attr_name'>company_name</span>, <span class='attr_name'>salary</span> &times; <span class='number'>1.10</span></sub>(&sigma;<sub><span class='attr_name'>salary</span> &times; <span class='number'>1.10</span> <span class='operator'>&le;</span> <span class='number'>100000</span></sub>(<span class='relvar'>managers</span>)) &cup; &Pi;<sub><span class='attr_name'>person_name</span>, <span class='attr_name'>company_name</span>, <span class='attr_name'>salary</span> &times; <span class='number'>1.03</span></sub>(&sigma;<sub><span class='attr_name'>salary</span> &times; <span class='number'>1.10</span> <span class='operator'>&gt;</span> <span class='number'>100000</span></sub>(<span class='relvar'>managers</span>))<br /><em>works</em> &larr; (<span class='relvar'>works</span> - <span class='relvar'>managers</span>) &cup; <span class='relvar'>updatedManagers</span>
</div>
<h2 id='Problem 2.7c'>Problem 2.7c</h2>
<div class='answer'>
<em>works</em> &larr; <span class='relvar'>works</span> - &sigma;<sub><span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"Small Bank Corporation"</span></sub>(<span class='relvar'>works</span>)
</div>
<h2 id='Problem 2.8a'>Problem 2.8a</h2>
<div class='answer'>
<em>userCounts</em> &larr; <sub><span class='attr_name'>account_number</span></sub><span class='group_operator'>G</span><sub><span class='func_name'>count</span>(<span class='attr_name'>customer_name</span>) <b>as</b> <em>user_count</em></sub>(<span class='relvar'>depositor</span>)<br />&Pi;<sub><span class='attr_name'>account_number</span>, <span class='attr_name'>branch_name</span>, <span class='attr_name'>balance</span></sub>(&sigma;<sub><span class='attr_name'>user_count</span> <span class='operator'>&gt;</span> <span class='number'>2</span></sub>(<span class='relvar'>userCounts</span> &bowtie; <span class='relvar'>account</span>))
</div>
<h2 id='Problem 2.8b'>Problem 2.8b</h2>
<div class='answer'>
<em>twoUsers</em> &larr; &sigma;<sub><span class='attr_name'>depositor</span>.<span class='attr_name'>account_number</span> <span class='operator'>=</span> <span class='attr_name'>test</span>.<span class='attr_name'>account_number</span></sub>(<span class='relvar'>depositor</span> &times; &rho;<sub><span class='attr_name'>test</span></sub>(<span class='relvar'>depositor</span>))<br /><em>threeUsers</em> &larr; &Pi;<sub><span class='attr_name'>depositor</span>.<span class='attr_name'>account_number</span></sub>(&sigma;<sub><span class='attr_name'>depositor</span>.<span class='attr_name'>account_number</span> <span class='operator'>=</span> <span class='attr_name'>account_number</span> &and; <span class='attr_name'>depositor</span>.<span class='attr_name'>customer_name</span> <span class='operator'>&ne;</span> <span class='attr_name'>customer_name</span> &and; <span class='attr_name'>test</span>.<span class='attr_name'>customer_name</span> <span class='operator'>&ne;</span> <span class='attr_name'>customer_name</span></sub>(<span class='relvar'>twoUsers</span> &times; &rho;<sub><span class='attr_name'>test2</span></sub>(<span class='relvar'>depositor</span>)))<br />&Pi;<sub><span class='attr_name'>account_number</span>, <span class='attr_name'>branch_name</span>, <span class='attr_name'>balance</span></sub>(&sigma;<sub><span class='attr_name'>account</span>.<span class='attr_name'>account_number</span> <span class='operator'>=</span> <span class='attr_name'>threeUsers</span>.<span class='attr_name'>account_number</span></sub>(<span class='relvar'>account</span> &times; <span class='relvar'>threeUsers</span>))
</div>
<h2 id='Problem 2.9a'>Problem 2.9a</h2>
<div class='answer'>
<em>counts</em> &larr; <sub><span class='attr_name'>company_name</span></sub><span class='group_operator'>G</span><sub><span class='func_name'>count</span>(<span class='attr_name'>person_name</span>) <b>as</b> <em>employees</em></sub>(<span class='relvar'>works</span>)<br /><em>smaller</em> &larr; &Pi;<sub><span class='attr_name'>counts</span>.<span class='attr_name'>company_name</span></sub>(&sigma;<sub><span class='attr_name'>counts</span>.<span class='attr_name'>employees</span> <span class='operator'>&lt;</span> <span class='attr_name'>test</span>.<span class='attr_name'>employees</span></sub>(<span class='relvar'>counts</span> &times; &rho;<sub><span class='attr_name'>test</span></sub>(<span class='relvar'>counts</span>)))<br />&Pi;<sub><span class='attr_name'>company_name</span></sub>(<span class='relvar'>works</span>) - <span class='relvar'>smaller</span>
</div>
<h2 id='Problem 2.9b'>Problem 2.9b</h2>
<div class='answer'>
<em>payrolls</em> &larr; <sub><span class='attr_name'>company_name</span></sub><span class='group_operator'>G</span><sub><span class='func_name'>sum</span>(<span class='attr_name'>salary</span>) <b>as</b> <em>total</em></sub>(<span class='relvar'>works</span>)<br /><em>larger</em> &larr; &Pi;<sub><span class='attr_name'>payrolls</span>.<span class='attr_name'>company_name</span></sub>(&sigma;<sub><span class='attr_name'>payroll</span>.<span class='attr_name'>total</span> <span class='operator'>&gt;</span> <span class='attr_name'>test</span>.<span class='attr_name'>total</span></sub>(<span class='relvar'>payrolls</span> &times; &rho;<sub><span class='attr_name'>test</span></sub>(<span class='relvar'>payrolls</span>)))<br />&Pi;<sub><span class='attr_name'>company_name</span></sub>(<span class='relvar'>works</span>) - <span class='relvar'>larger</span>
</div>
<h2 id='Problem 2.9c'>Problem 2.9c</h2>
<div class='answer'>
<em>avgSalaries</em> &larr; <sub><span class='attr_name'>company_name</span></sub><span class='group_operator'>G</span><sub><span class='func_name'>avg</span>(<span class='attr_name'>salary</span>) <b>as</b> <em>average</em></sub>(<span class='relvar'>works</span>)<br />&Pi;<sub><span class='attr_name'>avgSalaries</span>.<span class='attr_name'>company_name</span></sub>(&sigma;<sub><span class='attr_name'>test</span>.<span class='attr_name'>company_name</span> <span class='operator'>=</span> <span class='string'>"First Bank Corporation"</span> &and; <span class='attr_name'>avgSalaries</span>.<span class='attr_name'>average</span> <span class='operator'>&gt;</span> <span class='attr_name'>test</span>.<span class='attr_name'>average</span></sub>(<span class='relvar'>avgSalaries</span> &times; &rho;<sub><span class='attr_name'>test</span></sub>(<span class='relvar'>avgSalaries</span>)))
</div>
</body>
</html>
